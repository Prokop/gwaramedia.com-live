/**
 * yith.infinitescroll.js
 *
 * @author Your Inspiration Themes
 * @package YITH Infinite Scrolling
 * @version 1.0.0
 */
(function(a,b,c){"use strict";a.yit_infinitescroll=function(d){var e,f=a.extend({nextSelector:"",navSelector:"",itemSelector:"",contentSelector:"",eventType:"scroll",presetLoader:"",customLoader:"",buttonLabel:"",buttonClass:"",loadEffect:"fadeIn"},d),g="undefined"!=typeof yith_infs_script&&yith_infs_script.shop,h="undefined"!=typeof yith_infs_script&&yith_infs_script.block_loader,i=!1,j=!1,k=!1,l=!1,m=a(f.nextSelector).attr("href"),n=[],o=[],p=function(d,e){b.location.pathname!=d&&(b.history.replaceState({url:""+d+""},"Title",d),e&&(c.title=e),a(c).trigger("yith_infs_url_changed",[d,e]))};if("pagination"!=f.eventType&&a(f.navSelector).hide(),g)var q=a(f.itemSelector).first(),r=q.nextUntil(".first",f.itemSelector).length+1;var s=function(){k&&a(f.navSelector).last().after("<div class=\"yith-infs-loader\">"+k+"</div>"),i=!0,m=decodeURIComponent(m),m=m.replace(/^(?:\/\/|[^\/]+)*\//,"/"),a.ajax({url:m,dataType:"html",cache:yith_infs_script.use_cache,success:function(d){e=a(f.itemSelector).last();var h=a(d),k=h.find(f.contentSelector),l=h.find(f.itemSelector),q=h.find(f.navSelector),s=h.find(f.nextSelector),u=m;if(s.length?m=s.attr("href"):(j=!0,a(c).trigger("yith-infs-scroll-finished")),g&&!e.hasClass("last")&&"pagination"!=f.eventType&&t(e,r,l),a(f.navSelector).replaceWith(q),"pagination"==f.eventType?(a(f.contentSelector).replaceWith(k),a(b).scrollTop(a(f.contentSelector).offset().top)):(e.after(l),a(f.navSelector).hide()),a(".yith-infs-loader").remove(),a(c).trigger("yith_infs_adding_elem",[l,u]),l.addClass("yith-infs-animated"),l.addClass(f.loadEffect),yith_infs_script.change_url){var v=h.filter("title").length?h.filter("title").text():"";"pagination"!=f.eventType&&(!n.length&&n.push([b.location.href,c.title]),n.push([u,v]),o.push(e)),"scroll"!=f.eventType&&p(u,v)}setTimeout(function(){i=!1,l.removeClass("yith-infs-animated"),l.removeClass(f.loadEffect),a(c).trigger("yith_infs_added_elem",[l,u])},1e3)}})},t=function(b,c,d){var e=c-b.prevUntil(".last",f.itemSelector).length,g=0;d.each(function(){var b=a(this);g++,b.removeClass("first"),b.removeClass("last"),0==(g-e)%c?b.addClass("first"):0==(g-(e-1))%c&&b.addClass("last")})};if("scroll"==f.eventType){var u=""==f.customLoader?f.presetLoader:f.customLoader;k="<img src=\""+u+"\">",a(b).on("scroll touchstart",function(){a(this).trigger("yith_infs_start")}),a(b).on("yith_infs_start",function(){var b=a(this),c=a(f.itemSelector).last();"undefined"!=typeof c&&(i||j||!(b.scrollTop()+b.height()>=c.offset().top-2*c.height())||s())})}else"button"==f.eventType?(l="<div class=\"yith-infs-button-wrapper\"><button id=\"yith-infs-button\" class=\""+f.buttonClass+"\">"+f.buttonLabel+"</button></div>",a(f.navSelector).last().after(l),a(c).on("yith-infs-scroll-finished",function(){a(".yith-infs-button-wrapper").remove()}),a("#yith-infs-button").off("click").on("click",function(){var b=a(this);i||(h&&b.block({message:null,overlayCSS:{background:"#fff url("+h+") no-repeat center",opacity:.5,cursor:"none"}}),s()),a(c).on("yith_infs_adding_elem",function(){h&&b.unblock()})})):"pagination"==f.eventType&&a(c).off("click",f.navSelector+" a").on("click",f.navSelector+" a",function(b){b.preventDefault(),m=a(this).attr("href"),h&&a(f.navSelector).block({message:null,overlayCSS:{background:"#fff url("+h+") no-repeat center",opacity:.5,cursor:"none"}}),s()});var v;a(b).on("scroll touchstart",function(){var c,d,f,g=a(b),h=g.scrollTop()+g.height();"undefined"!=typeof e&&n.length&&(c=o.indexOf(e),f=e.offset().top+e.height(),h<v?h<=f&&(d=c?c-1:c,e=o[d],p(n[c][0],n[c][1])):h>f+250&&(c+1<o.length&&(e=o[c+1]),p(n[c+1][0],n[c+1][1])),v=h)})}})(jQuery,window,document);